--- gtk/gtkdatabox.c	2011-05-21 12:39:01.583594722 +0200
+++ gtk/gtkdatabox.c	2011-05-21 12:38:43.523595004 +0200
@@ -453,7 +453,8 @@
       gint width;
       gint height;
 
-      gdk_drawable_get_size (widget->window, &width, &height);
+      width = gdk_window_get_width(widget->window);
+      height = gdk_window_get_height(widget->window);
       x = MAX (0, MIN (width - 1, x));
       y = MAX (0, MIN (height - 1, y));
 
@@ -587,7 +588,7 @@
    gint attributes_mask;
 
    box = GTK_DATABOX (widget);
-   GTK_WIDGET_SET_FLAGS (box, GTK_REALIZED);
+   gtk_widget_set_realized(box, GTK_REALIZED);
 
    attributes.window_type = GDK_WINDOW_CHILD;
    attributes.x = widget->allocation.x;
--- gtk/gtkdatabox.c	2011-05-21 12:39:01.583594722 +0200
+++ gtk/gtkdatabox.c	2011-05-21 12:38:43.523595004 +0200
@@ -453,7 +453,8 @@
       gint width;
       gint height;
 
-      gdk_drawable_get_size (widget->window, &width, &height);
+      width = gdk_window_get_width(widget->window);
+      height = gdk_window_get_height(widget->window);
       x = MAX (0, MIN (width - 1, x));
       y = MAX (0, MIN (height - 1, y));
 
@@ -587,7 +588,7 @@
    gint attributes_mask;
 
    box = GTK_DATABOX (widget);
-   GTK_WIDGET_SET_FLAGS (box, GTK_REALIZED);
+   gtk_widget_set_realized(box, GTK_REALIZED);
 
    attributes.window_type = GDK_WINDOW_CHILD;
    attributes.x = widget->allocation.x;
